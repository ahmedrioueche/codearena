import{o as R,j as e,p as U,r as n,q as X,X as H,L as f,k as J,m as K,s as h,v as S,w as Q,c as W,I as Y,d as Z,R as y}from"./index-evChX1jM.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=R("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),ee=({value:s,onChange:r})=>e.jsx("div",{className:"h-[300px]",children:e.jsx(U,{starterCode:s,currentCode:s,onCodeChange:r,gameMode:"solo"})}),se=({testCase:s,testResult:r,toggleTestCaseExpansion:o,runTestCase:m,updateTestCaseInput:u})=>{const[t,l]=n.useState("idle");return e.jsxs("div",{className:"bg-gray-300 dark:bg-gray-800 rounded-lg overflow-hidden border border-light-border dark:border-dark-border",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-300 dark:bg-gray-800 cursor-pointer",onClick:()=>o(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[(r==null?void 0:r.passed)!==void 0&&e.jsx("span",{className:`rounded-full p-1 ${r.passed?"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400":"bg-red-100 text-red-600 dark:bg-red-900 dark:text-red-400"}`,children:r.passed?e.jsx(X,{size:16}):e.jsx(H,{size:16})}),e.jsxs("span",{className:"font-medium truncate",children:["Test Case ",s.id]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-1 rounded hover:scale-110 transition duration-300",onClick:async d=>{d.stopPropagation(),l("loading");const x=await m(s);l(x)},children:t==="loading"?e.jsx(f,{className:"animate-spin text-light-primary dark:text-dark-primary",size:22}):e.jsx(_,{size:22,className:"text-light-primary dark:text-dark-primary"})}),s.expanded?e.jsx(J,{size:18}):e.jsx(K,{size:18})]})]}),s.expanded&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(ee,{label:"function",value:s==null?void 0:s.testFunction,onChange:d=>u(s.id,d)}),s.validationResult&&e.jsx("div",{className:"mt-4 p-3 bg-gray-200 dark:bg-gray-700 rounded-lg",children:e.jsx("p",{className:"text-base text-gray-700 dark:text-gray-300",children:"Test is valid!"})}),!r&&s.validationAccuracy!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Test Accuracy"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.validationAccuracy,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${s.validationAccuracy}%`}})})]}),r&&r.accuracy!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Code Accuracy"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.accuracy,"%"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${r.accuracy}%`}})})]}),r&&r.errors&&Array.isArray(r.errors)&&r.errors.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-800 rounded-lg overflow-hidden",children:e.jsx("ul",{className:"list-disc list-inside text-red-800 dark:text-red-200",children:r.errors.map((d,x)=>e.jsx("li",{className:"break-words whitespace-normal overflow-wrap-anywhere",children:d},x))})})]})]})},ae=({testCases:s,addTestCase:r,toggleTestCaseExpansion:o,runTestCase:m,updateTestCaseFunction:u,testCasesResult:t})=>e.jsx("div",{className:"space-y-4 mb-6",children:s.length===0?e.jsxs("div",{className:"text-center py-8  rounded-lg",children:[e.jsx("p",{className:"mb-4",children:"No test cases yet."}),e.jsx(h,{onClick:r,variant:"primary",children:e.jsxs("div",{className:"flex flex-row space-x-2",children:[e.jsx(S,{}),e.jsx("span",{className:"ml-2",children:"Add Test Case"})]})})]}):s&&Array.isArray(s)&&s.map(l=>e.jsx(se,{testCase:l,testResult:t.find(d=>d.id===l.id),toggleTestCaseExpansion:o,runTestCase:m,updateTestCaseInput:u},l.id))});function le({problem:s,solution:r,isCollapsed:o,onToggleCollapse:m,isNew:u}){const[t,l]=n.useState([]),[d,x]=n.useState(!1),[v,N]=n.useState(!1),[b,p]=n.useState(!1),{getTestCases:E,validateTestCases:I,runTestCases:w}=Q(),[k,C]=n.useState(!1),[V,z]=n.useState(!1),[T,G]=n.useState(""),[P,j]=n.useState([]),{isMobile:$}=W();n.useEffect(()=>{G(r)},[r]),n.useEffect(()=>{C(!1),z(!1),l([]),j([])},[u]);const A=()=>{const a={id:`${t.length+1}`,input:"",expectedOutput:"",expanded:!0};l(i=>[...i,a])},F=async()=>{x(!0);try{if(s){const a=await E(s);l(i=>[...i,...a]),C(!0)}}catch(a){console.error("Failed to generate test cases:",a)}finally{x(!1)}},L=n.useCallback(async()=>{N(!0);try{if(s){const a=await I(t,s);a&&l(a)}}catch(a){console.error("Validation failed:",a)}finally{N(!1)}},[t]),B=async()=>{p(!0);try{if(s){const a=await w(s,t,T);console.log("result",a),a&&j(a)}}catch(a){console.log("Error running tests",a)}finally{p(!1)}},M=async a=>{try{const i=[a];if(s){const c=await w(s,i,T);c&&c.length>0&&j(g=>[...g.filter(O=>O.id!==a.id),c[0]])}return"success"}catch(i){return console.log("Error running tests",i),"error"}finally{p(!1)}},q=n.useCallback(a=>{l(i=>i.map(c=>c.id===a?{...c,expanded:!c.expanded}:c))},[]),D=n.useCallback((a,i)=>{l(c=>c.map(g=>g.id===a?{...g,testFunction:i}:g))},[]);return e.jsx("div",{className:`relative h-full transition-all duration-300 flex flex-col mt-4 pb-10 dark:text-white text-black ${o?"w-12":"w-full"}`,role:"region","aria-label":"test-cases",children:!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col mb-6 px-4",children:[!$&&e.jsxs("div",{className:"flex flex-row justify-between mb-4 items-center",children:[e.jsx("h2",{className:"text-lg",children:"Test Cases"}),e.jsx(Y,{onClick:m,icon:Z})]}),e.jsx("div",{className:"flex flex-col gap-2 items-start",children:e.jsxs(h,{onClick:F,disabled:d||k,variant:"primary",className:"w-full md:w-auto",children:[d?e.jsx(f,{className:"animate-spin"}):e.jsx(y,{}),e.jsx("span",{className:"ml-2",children:"Generate using AI"})]})})]}),e.jsx("div",{className:"flex-1 overflow-auto px-4",children:e.jsx(ae,{testCases:t,addTestCase:A,toggleTestCaseExpansion:q,runTestCase:M,updateTestCaseFunction:D,testCasesResult:P})}),e.jsx("div",{className:"mt-4 px-4 py-1",children:e.jsxs("div",{className:"flex md:flex-row flex-col gap-2",children:[e.jsxs(h,{onClick:A,variant:"primary",className:"w-full md:w-auto px-2",children:[e.jsx(S,{}),e.jsx("span",{className:"ml-2",children:"Add"})]}),e.jsxs(h,{onClick:()=>{L()},disabled:v||k||V||t.length===0,variant:"primary",className:"w-full md:w-auto px-2",children:[v?e.jsx(f,{className:"animate-spin"}):e.jsx(y,{}),e.jsx("span",{className:"ml-2",children:"Validate"})]}),e.jsxs(h,{onClick:()=>{B()},disabled:b||t.length===0,variant:"primary",className:"w-full md:w-auto px-2",children:[b?e.jsx(f,{className:"animate-spin"}):e.jsx(y,{}),e.jsx("span",{className:"ml-2",children:"Run"})]})]})})]})})}export{le as default};
